(() => {
  const PASSWORD = 'makoto';
  const redirectUrl = 'Klearn.github.io/password'; // ← 相対パスに変更

  const input = document.getElementById('pw');
  const msg = document.getElementById('msg');
  const form = document.getElementById('pwForm');

  function showMessage(text, ok=false){
    msg.textContent = text;
    msg.style.color = ok ? '#16a34a' : 'var(--danger)';
  }

  function wrong(){
    showMessage('パスワードが違います');
    input.classList.remove('shake');
    void input.offsetWidth;
    input.classList.add('shake');
    input.value='';
    input.focus();
  }

  function correct(){
    showMessage('認証に成功しました。移動します…', true);
    setTimeout(() => location.href = redirectUrl, 500);
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const val = input.value.trim();
    if(!val) return showMessage('パスワードを入力してください');
    val === PASSWORD ? correct() : wrong();
  });

  input.focus();
})();
